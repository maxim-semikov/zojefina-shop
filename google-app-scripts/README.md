# Google Apps Script

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –º–∞–≥–∞–∑–∏–Ω–∞ [Zojefina](https://zojefina.shop).

## –ü—Ä–æ–µ–∫—Ç—ã

### üì¶ [orders-processing](orders-processing/)

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ –≥–æ—Ç–æ–≤–∫–∏ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤:

- `importOrders.js` - –∏–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤ —Ç–µ–∫—É—â—É—é —Ç–∞–±–ª–∏—Ü—É —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- `fillDeliveryDates.js` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞—Ç –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ (–≤—Å–µ –∏–ª–∏ –ø–æ –Ω–æ–º–µ—Ä—É)
- `cleanupImportedOrders.js` - —É–¥–∞–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
- `buildCookingPlanByDate.js` - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –≥–æ—Ç–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏
- `invoice.js` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –¥–∞—Ç–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏
- `main.js` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å –º–µ–Ω—é –∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- `utils.js` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### ÔøΩ [analytics](analytics/)

–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥:

- `main.js` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–µ–Ω—é ¬´–ê–Ω–∞–ª–∏—Ç–∏–∫–∞¬ª –∏ UI-–ø—Ä–æ–º–ø—Ç –¥–ª—è –≤–≤–æ–¥–∞ –ø–µ—Ä–∏–æ–¥–∞
- `reports.js` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞: –æ–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏, —Ç–æ–ø –±–ª—é–¥, –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏, –ø—Ä–æ–º–æ–∫–æ–¥—ã, —Ç–∏–ø—ã –¥–æ—Å—Ç–∞–≤–∫–∏
- `config.js` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: –∏–º—è –ª–∏—Å—Ç–∞-–∏—Å—Ç–æ—á–Ω–∏–∫–∞, –º–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫
- `utils.js` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Orders_Raw, –∞–≥—Ä–µ–≥–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤, –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç

### ÔøΩüîó [tilda-webhook-import-orders](tilda-webhook-import-orders/)

–ò–º–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤ –∏–∑ Tilda —á–µ—Ä–µ–∑ webhook –≤ Google Sheets:

- `main.js` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç Tilda
- `config.js` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `token.js` - —Ä–∞–±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏
- `protectRawSheet.js` - –∑–∞—â–∏—Ç–∞ –ª–∏—Å—Ç–∞ —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- `utils.js` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `appsscript.json` - –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (orders-processing)

- **–ò–º–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–º–µ—Ç–∫–æ–π —Å—Ç–∞—Ç—É—Å–∞
- **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞—Ç –¥–æ—Å—Ç–∞–≤–∫–∏** - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–∞—Ç –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–Ω—è –ø—Ä–∏—ë–º–∞ –∏ —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏, —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫
- **–ü–ª–∞–Ω –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è** - –∞–≥—Ä–µ–≥–∞—Ü–∏—è –±–ª—é–¥ –ø–æ –¥–∞—Ç–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏ —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ –±–µ–∑ –¥–∞—Ç—ã
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö** - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö –ø–æ –Ω–æ–º–µ—Ä—É –∑–∞–∫–∞–∑–∞ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –¥–∞—Ç–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏, –≤–∫–ª—é—á–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∫–∏–¥–∫–∞—Ö –∏ –∫–∞–ª–æ—Ä–∏—è—Ö
- **–û—á–∏—Å—Ç–∫–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - —É–¥–∞–ª–µ–Ω–∏–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

### –ü—Ä–∏—ë–º –∑–∞–∫–∞–∑–æ–≤ (tilda-webhook-import-orders)

- **Webhook –¥–ª—è Tilda** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏—ë–º –∑–∞–∫–∞–∑–æ–≤ –∏–∑ Tilda CMS —á–µ—Ä–µ–∑ POST-–∑–∞–ø—Ä–æ—Å—ã
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–∞–±–æ—á–∏–π –ª–∏—Å—Ç (Orders) –∏ –ª–∏—Å—Ç —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Raw)
- **–¶–≤–µ—Ç–æ–≤–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –∑–∞–∫–∞–∑–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –ª–∏—Å—Ç–∞ —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (analytics)

- **–û—Ç—á—ë—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥** ‚Äî —á–µ—Ä–µ–∑ –º–µ–Ω—é ¬´–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Üí –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç¬ª –∑–∞–¥–∞—ë—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (dd.MM.yyyy), –¥–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –ª–∏—Å—Ç–∞ `Orders_Raw` –≤–Ω–µ—à–Ω–µ–≥–æ spreadsheet
- **–û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤, –≤—ã—Ä—É—á–∫–∞, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, —Å—É–º–º–∞ —Å–∫–∏–¥–æ–∫
- **–¢–æ–ø-10 –±–ª—é–¥** ‚Äî —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å —á–∏—Å–ª–æ–º –∑–∞–∫–∞–∑–æ–≤
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π –ø–æ –∫–∞–∂–¥–æ–º—É –¥–Ω—é (–ü–Ω‚Äì–í—Å)
- **–ü—Ä–æ–º–æ–∫–æ–¥—ã** ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: —á–∏—Å–ª–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π –∏ —Å—É–º–º–∞ —Å–∫–∏–¥–æ–∫ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–æ–¥—É
- **–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–∏–ø–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞** ‚Äî `SOURCE_RAW_SPREADSHEET_ID` –∑–∞–¥–∞—ë—Ç—Å—è –≤ Script Properties –ø—Ä–æ–µ–∫—Ç–∞

## –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Google**

   ```bash
   clasp login
   ```

2. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**

   –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω—É–∂–µ–Ω —Ñ–∞–π–ª `.clasp.json` —Å Script ID –∏–∑ Google Apps Script.

   **–ö–∞–∫ –Ω–∞–π—Ç–∏ Script ID:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ [Google Apps Script](https://script.google.com)
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ ‚öôÔ∏è "Project Settings"
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ "Script ID"

   **–°–æ–∑–¥–∞–π—Ç–µ `.clasp.json`** –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

   ```json
   {
     "scriptId": "–í–ê–®_SCRIPT_ID",
     "rootDir": "."
   }
   ```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É—è helper-—Å–∫—Ä–∏–ø—Ç):

```bash
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Google
./deploy.sh orders-processing push
./deploy.sh tilda-webhook push
./deploy.sh analytics push

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ Google
./deploy.sh orders-processing pull
./deploy.sh tilda-webhook pull
./deploy.sh analytics pull

# –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
./deploy.sh orders-processing open
./deploy.sh tilda-webhook open
./deploy.sh analytics open
```

#### –ù–∞–ø—Ä—è–º—É—é (–∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞):

```bash
cd orders-processing  # –∏–ª–∏ tilda-webhook-import-orders

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Google Apps Script
clasp push

# –°–∫–∞—á–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ Google Apps Script
clasp pull

# –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
clasp open

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å
clasp status

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
clasp push --watch
```

### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

1. **–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:** `clasp pull` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. **–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã** –ª–æ–∫–∞–ª—å–Ω–æ –≤ VS Code
3. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `clasp push` - –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ Google
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** –≤ Google Apps Script, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- `.clasp.json` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore` –∏ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è (—Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π Script ID)
- `appsscript.json` - –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º `clasp pull` –º–æ–≥—É—Ç —Å–∫–∞—á–∞—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ Google

### –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

**–û—à–∏–±–∫–∞ –ø—Ä–∏ push/pull:**

```bash
clasp logout
clasp login
```

**–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**

```bash
clasp clone YOUR_SCRIPT_ID
```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è clasp](https://github.com/google/clasp)
- [Google Apps Script](https://script.google.com)
- [Google Apps Script API](https://developers.google.com/apps-script/api)
